---
layout: post
title: "Bing Maps - Geocoding in PowerShell"
date: 2011-08-19 05:05:00
tags: gis powershell
comments: true
---
<p>
Since I had fun using the Bing Maps API in C# (see <a title="Bing Maps – Geocoding and Imagery" href="http://kevinpelgrims.com/blog/2011/08/16/bing-maps-geocoding-and-imagery/">Bing Maps - Geocoding and Imagery</a>), I decided to try and do the same in PowerShell. This didn't seem to be very hard either, as it's possible to use the same objects as you would in a regular .NET application. Go PowerShell!
<br />
The only difference is the web service trick on the second line.
</p>

<pre class="prettyprint">
$key = &quot;apikey&quot;;
$ws = New-WebServiceProxy -uri http://dev.virtualearth.net/webservices/v1/geocodeservice/geocodeservice.svc?wsdl;
$wsgr = New-Object Microsoft.PowerShell.Commands.NewWebserviceProxy.AutogeneratedTypes.WebServiceProxy1ervice_geocodeservice_svc_wsdl.GeocodeRequest;

$wsc = New-Object Microsoft.PowerShell.Commands.NewWebserviceProxy.AutogeneratedTypes.WebServiceProxy1ervice_geocodeservice_svc_wsdl.Credentials;
$wsc.ApplicationId = $key;
$wsgr.Credentials = $wsc;

$wsgr.Query = 'Brussels, Belgium';
$wsr = $ws.Geocode($wsgr);

$wsr.Results[0] | select {$_.Address.FormattedAddress}, {$_.Locations[0].Longitude}, {$_.Locations[0].Latitude};
</pre>

When you execute this in PowerShell, it looks like this:

<div class="imagecaption" style="width: 500px;">
 <a href="http://kevinpelgrims.com/blog/files/images/2011/08/bingapi_powershell.png"><img title="Bing Maps PowerShell" src="http://kevinpelgrims.com/blog/files/images/2011/08/bingapi_powershell.png" alt="" width="500" height="153" /></a>
 <br /><span class="caption">Geocoding in PowerShell</span>
</div>

<p>
Things like this make you think about the power of PowerShell. If you can do it in .NET, you can do it in PS!
</p>
